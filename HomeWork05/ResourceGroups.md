## Настройка Resource Groups для разных типов запросов ##   
   
### Ресурсные группы, созданные по умолчанию ###   
При создании Arenadata DB 7.2 с помощью Arenadata Cluster Manager и bundles создаются следующие ресурсные группы:
```
select * from gp_toolkit.gp_resgroup_config;
```
|groupid|groupname|concurrency|cpu_max_percent|cpu_weight|cpuset|memory_limit|min_cost|io_limit|
|-------|---------|-----------|---------------|----------|------|------------|--------|--------|
|6437|default_group|20|20|100|-1|-1|500|-1|
|6438|admin_group|10|10|100|-1|-1|500|-1|
|6441|system_group|0|10|100|-1|-1|500|-1|
### Назначение ресурсных групп по умолчанию ###
```
select r.rolname, rg.rsgname
from pg_roles r
     join pg_resgroup rg on r.rolresgroup = rg.oid
```
|rolname|rsgname|
|-------|-------|
|pg_monitor|admin_group|
|pg_read_all_settings|admin_group|
|pg_read_all_stats|admin_group|
|pg_stat_scan_tables|admin_group|
|pg_read_server_files|admin_group|
|pg_write_server_files|admin_group|
|pg_execute_server_program|admin_group|
|pg_signal_backend|admin_group|
|gpadmin|admin_group|


### Команды создания ресурсных групп в Greenplum 7 / Arenadata DB 7.2 ### 
Команды создания ресурсных групп в Greenplum 7 / Arenadata DB 7.2 отличаются от команд Greenplum 6, рассмотренных на лекции.
Для написания команд создания ресурсных групп Arenadata DB 7.2 воспользовался документацией:   
[CREATE_RESOURCE_GROUP](https://techdocs.broadcom.com/us/en/vmware-tanzu/data-solutions/tanzu-greenplum/7/greenplum-database/ref_guide-sql_commands-CREATE_RESOURCE_GROUP.html)  
```
CREATE RESOURCE GROUP rgroup1 WITH (   
    CONCURRENCY=<integer>  -- The maximum number of concurrent transactions, including active and idle transactions, that are permitted for this resource group.   
    CPU_MAX_PERCENT=<integer>  -- The percentage of the maximum available CPU resources that the resource group can use.   
    CPUSET=<coordinator_cores>;<segment_cores>  -- the CPU cores to reserve for this resource group on the coordinator host and on segment hosts.   
    CPU_WEIGHT=<integer>  -- The scheduling priority of the current group (1-500).   
    MEMORY_LIMIT=<integer>  -- The maximum available memory, in MB, to reserve for this resource group.   
    MIN_COST=<integer>  -- The limit on the cost of the query plan generated by a query in this resource group.    
    IO_LIMIT=' <tablespace_io_limit_spec> -- The maximum read/write sequential disk I/O throughput, and the maximum read/write I/O operations per second for the queries assigned to a specific resource group.   
    );   
```
### Создание ресурсной группы для "тяжелых" запроосов ###   
Для "тяжелых" запроосов выделяется больше ресурсов CPU и большой объем памяти:
```
create resource group rgroup1 with (concurrency=10, cpu_max_percent=30, memory_limit=30);
```
### Создание ресурсной группы для "легких" запроосов ### 
Для "легких" запроосов выделяется меньше ресурсов CPU и меньший объем памяти:
```
create resource group rgroup2 with (concurrency=5, cpu_max_percent=5, memory_limit=5); 
```

